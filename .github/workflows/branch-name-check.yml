name: Branch Name Validation

on:
  push:
    branches:
      - master
      - develop
  pull_request:
    branches:
      - master
      - develop

jobs:
  validate-branch-name:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        
      - name: Validate branch name
        run: |
          branch_name=$(echo "${GITHUB_REF#refs/heads/}")
          pattern="^(feature|bugfix|RELEASE)\/(hcmpre|dpg|sn)-[0-9]{1,5}$"
          if [[ ! "$branch_name" =~ $pattern ]]; then
            echo "Branch name '$branch_name' does not follow the correct pattern: feature/hcmpre-<TICKET_NO>, feature/dpg-<TICKET_NO>, feature/sn-<TICKET_NO>, bugfix/sn-<TICKET_NO>,  bugfix/hcmpre-<TICKET_NO>, or bugfix/dpg-<TICKET_NO> where x is a number between 0 and 99999"
            exit 1
          fi
